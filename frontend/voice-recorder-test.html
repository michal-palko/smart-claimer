<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Recorder Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="voiceRecorder.css">
</head>
<body class="bg-light">
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <h1 class="mb-4">Voice Recorder Test</h1>
                
                <div class="card p-4">
                    <div class="mb-3">
                        <label for="testPopis" class="form-label">Test Popis Field</label>
                        <textarea class="form-control" id="testPopis" rows="4" 
                                  placeholder="Transcribed text will appear here..."></textarea>
                    </div>
                    
                    <div class="mb-3">
                        <h5>Instructions:</h5>
                        <ol>
                            <li>Make sure your Whisper API is running on port 3001</li>
                            <li>Allow microphone access when prompted</li>
                            <li>Click "Nahrávať" to start recording</li>
                            <li>Speak clearly in Slovak</li>
                            <li>Click "Zastaviť" to stop recording</li>
                            <li>Wait for transcription to complete</li>
                            <li>Click "Použiť text" to add to text area</li>
                        </ol>
                    </div>
                    
                    <div class="alert alert-info" role="alert">
                        <strong>API Endpoint:</strong> <span id="apiEndpoint"></span>
                    </div>
                    
                    <div class="mb-3">
                        <label for="apiUrlInput" class="form-label">Custom API URL (optional):</label>
                        <input type="url" class="form-control" id="apiUrlInput" 
                               placeholder="http://localhost:3001/transcribe">
                        <button type="button" class="btn btn-secondary btn-sm mt-2" onclick="updateApiUrl()">
                            Update API URL
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="voiceRecorder.js"></script>
    <script>
        let voiceRecorder = null;
        
        function getWhisperApiUrl() {
            return 'http://localhost:3001/transcribe';
        }
        
        function updateApiUrl() {
            const customUrl = document.getElementById('apiUrlInput').value;
            if (customUrl) {
                // Destroy existing recorder
                if (voiceRecorder) {
                    voiceRecorder.destroy();
                }
                
                // Create new recorder with custom URL
                voiceRecorder = new VoiceRecorder('testPopis', {
                    apiUrl: customUrl,
                    language: 'sk',
                    prompt: 'Popis práce, technické úlohy, programovanie'
                });
                
                document.getElementById('apiEndpoint').textContent = customUrl;
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize voice recorder for test
            voiceRecorder = new VoiceRecorder('testPopis', {
                apiUrl: getWhisperApiUrl(),
                language: 'sk',
                prompt: 'Popis práce, technické úlohy, programovanie'
            });
            
            // Show current API endpoint
            document.getElementById('apiEndpoint').textContent = getWhisperApiUrl();
        });
    </script>
</body>
</html>
